<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Network-Based Website Fingerprinting</title>
<meta content="Ian Goldberg" name="author">
<meta content="Tao Wang" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       The IETF is well on its way to protecting connection metadata with protocols such as DNS-over-TLS
and DNS-over-HTTPS, and work-in-progress towards encrypting the TLS SNI. However, more
work is needed to protect traffic metadata, especially in the context of web traffic.
In this document, we survey Website Fingerprinting attacks, which are a class of attacks that
use machine learning techniques to attack web privacy, and highlight metadata leaks used
by said attacks. We also survey proposed mitigations for such leakage and discuss their
applicability to IETF protocols such as TLS, QUIC, and HTTP. We endeavor to show that
Website Fingerprinting attacks are a serious problem that affect all Internet users,
and we pose open problems and directions for future research in this area. 
    " name="description">
<meta content="xml2rfc 2.39.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-pearg-website-fingerprinting-latest" name="ietf.draft">
<link href="draft-irtf-pearg-website-fingerprinting.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.9; /* TODO fix when Henrik takes the patch. */
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Network-Based Website Fingerprinting</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Goldberg, et al.</td>
<td class="center">Expires 5 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">pearg</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-pearg-website-fingerprinting-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-04" class="published">4 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-05">5 September 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">I. Goldberg</div>
<div class="org">University of Waterloo</div>
</div>
<div class="author">
      <div class="author-name">T. Wang</div>
<div class="org">HK University of Science and Technology</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Apple, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Network-Based Website Fingerprinting</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The IETF is well on its way to protecting connection metadata with protocols such as DNS-over-TLS
and DNS-over-HTTPS, and work-in-progress towards encrypting the TLS SNI. However, more
work is needed to protect traffic metadata, especially in the context of web traffic.
In this document, we survey Website Fingerprinting attacks, which are a class of attacks that
use machine learning techniques to attack web privacy, and highlight metadata leaks used
by said attacks. We also survey proposed mitigations for such leakage and discuss their
applicability to IETF protocols such as TLS, QUIC, and HTTP. We endeavor to show that
Website Fingerprinting attacks are a serious problem that affect all Internet users,
and we pose open problems and directions for future research in this area.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/chris-wood/ietf-fingerprinting">https://github.com/chris-wood/ietf-fingerprinting</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-website-fingerprinting" class="xref">Website Fingerprinting</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-attacks" class="xref">Attacks</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-base-rate-fallacy" class="xref">Base Rate Fallacy</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-defenses" class="xref">Defenses</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-traffic-morphing" class="xref">Traffic Morphing</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-traffic-splitting" class="xref">Traffic Splitting</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-open-problems-and-direction" class="xref">Open Problems and Directions</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-protocol-design-considerati" class="xref">Protocol Design Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Internet protocols such as TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> and QUIC <span>[<a href="#I-D.ietf-quic-transport" class="xref">I-D.ietf-quic-transport</a>]</span>
bring substantial improvements to end-users.
The IETF engineered these with security and privacy in mind by encrypting
more protocol messages using modern cryptographic primitives and algorithms, and engineering
against flaws found in previous protocols, yielding several desirable security
properties, including: forward-secure session key secrecy, downgrade protection, key
compromise impersonation resistance, and protection of endpoint identities.
Combined, these two protocols are set to protect a significant amount of Internet data.
However, significant metadata leaks still exist for users of these protocols. Examples include
plaintext TLS SNI and application-specific extensions (ALPN), as well as DNS queries. This information
can be used by a passive attacker to learn information about the contents of an otherwise
encrypted network connection. Recently, such information has also been studied as a means
of building unique user profiles <span>[<a href="#li2018can" class="xref">li2018can</a>]</span>. It has also been used to build flow classifiers
that aid network management <span>[<a href="#foremski2014dns" class="xref">foremski2014dns</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In the context of Tor, a popular low-latency anonymity network, a common class of attacks that use
metadata for such inference is called Website Fingerprinting (WF).
These attacks use machine learning techniques built with
features extracted from metadata such as traffic patterns to attack web (browsing) privacy.
Miller et al. <span>[<a href="#miller2014know" class="xref">miller2014know</a>]</span> show how these attacks can be applied to web browsing
traffic protected with HTTPS to reveal private information about users.
Pironti et al. <span>[<a href="#pironti2012identifying" class="xref">pironti2012identifying</a>]</span> use similar attacks based on data sizes to
identify individual social media clients using encrypted connections.
Fingerprinting attacks using encrypted traffic analysis are also applicable to encrypted
media streams, such as Netflix videos. (See work from Reed et al. <span>[<a href="#reed2017identifying" class="xref">reed2017identifying</a>]</span>
and Schuster et al. <span>[<a href="#schuster2017beauty" class="xref">schuster2017beauty</a>]</span>
for examples of these attacks.) WF attacks have also been applied to other IETF
protocols such as encrypted DNS, including dnscrypt, DNS-over-TLS,
and DNS-over-HTTPS <span>[<a href="#siby2018dns" class="xref">siby2018dns</a>]</span><span>[<a href="#shulman2014pretty" class="xref">shulman2014pretty</a>]</span>. In the past, they have also
been conducted remotely <span>[<a href="#gong2010fingerprinting" class="xref">gong2010fingerprinting</a>]</span>, using buffer-based side channels
in a victim's home router.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Protocols such as DNS-over-TLS and DNS-over-HTTPS <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, and work-in-progress
towards encrypting the TLS SNI extension <span>[<a href="#I-D.ietf-tls-esni" class="xref">I-D.ietf-tls-esni</a>]</span>, help minimize metadata
sent in cleartext on the wire. However, regardless of protocol and even network-layer
fingerprinting mitigations, application layer specifics, e.g., web page sizes and client
request patterns, reveal a noticeable amount of information to attackers. We argue
that much more work is needed to protect encrypted connection metadata, especially
in the context of web traffic.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In this document, we describe WF attacks in the context of IETF protocols such as TLS and
QUIC. We survey WF attacks and highlight metadata features and classification techniques
used to conduct said attacks. We also describe proposed mitigations for these attacks
and discuss their applicability to IETF protocols. We conclude with a discussion of open
problems and directions for future research and advocate for more work in this area.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-background">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-2-1">In this section we review how most secure Internet connections are made today. We omit custom
configurations such as those using VPNs and proxies since they do not represent the common case
for most Internet users. The following steps briefly describe the sequence of events that
normally occur when a web client, e.g., browser, curl, etc., connects to a website and obtains
some resource. First an unencrypted DNS query is sent to an untrusted DNS recursive
resolver to resolve a name to an IP address. Upon receipt, clients then open a TCP and TLS
connection to the destination address. During this stage, metadata such as the TLS SNI and ALPN
values are sent in cleartext. The SNI is used to denote the destination application or endpoint
to which clients want to connect. Servers use this for several purposes, including selecting
an appropriate certificate (one with the SNI name in the SubjectAlternativeName list) or
routing to a different backend terminator. ALPN values are used to negotiate which application-layer
protocol will be used on top of the TLS connection. Common values include "http/1.1", "h2", and
(soon) "h3". Upon connection, clients then send HTTP messages to obtain the desired resource.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Connections look different (on the wire) with TLS 1.3, encrypted DNS via DNS-over-TLS or
DNS-over-HTTPS, and encrypted SNI.
DNS queries are encrypted to a (trusted) recursive resolver and TLS metadata such as SNI
are encrypted in transit to the terminator. Despite the reduction in cleartext metadata
sent over the wire, there still remains several sources of information that an adversary
may use for malicious purposes, including: size and timing of DNS queries and responses,
size and timing or application traffic, and connection attempts induced while loading a
web resource, e.g., Javascript files. So while technologies such as Encrypted SNI, DoT,
and DoH help protect some metadata, they are not complete solutions to the larger problem.
In the following section, we discuss this overarching problem in detail.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="website-fingerprinting">
<section id="section-3">
      <h2 id="name-website-fingerprinting">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-website-fingerprinting" class="section-name selfRef">Website Fingerprinting</a>
      </h2>
<p id="section-3-1">Website Fingerprinting (WF) is a class of attacks that exploit metadata leakage to attack
end-user privacy on the Internet. In the WF threat model,
Adv is assumed to be a passive and local attacker. Local means that Adv can associate
traffic with a given client. Examples include proxies to which clients directly connect.
Passive means that Adv can only view traffic in transit. It cannot add, drop, or otherwise
modify packets between the victim client and server(s). Use of reliable and encrypted transport
protocols such as TLS limit on-path attackers to eavesdropping on encrypted packets. (In
QUIC, however, reordering packets is possible.)<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Traffic features used for classification include properties such as packet size, timing,
direction, interarrival times, and burstiness, among many others <span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span>. Normally, features
are restricted to those which are extractable as a passive eavesdropper, and not those which
are viewable by modifying client or server behavior. Specifically, this means that
attacks such as CRIME <span>[<a href="#CRIME" class="xref">CRIME</a>]</span> and TIME <span>[<a href="#TIME" class="xref">TIME</a>]</span>, which rely on an attacker abusing TLS-layer compression
to leak contents of an encrypted connection, are out of scope.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Website Fingerprinting attacks have evolved over the years through three phases:
(1) Closed-world WF on SSL/TLS, (2) Closed-world WF on Tor, and (3) Open-world WF on Tor.<a href="#section-3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3-4">
        <li id="section-3-4.1">In the closed-world model, clients are assumed to only visit a small set of pages monitored by Adv.
This is less realistic but easier to analyze than the open-world model discussed below,
and so the earliest results achieved success on SSL/TLS in this model.
(For a realistic attack, Adv would need to monitor every possible page of interest to each client, which is impractical.)
Attacks against proxy-based privacy technologies such as VPNs and SSH tunneling,
which has almost no effect on the network, falls under this category as well.<a href="#section-3-4.1" class="pilcrow">¶</a>
</li>
<li id="section-3-4.2">Tor, an anonymity network built on onion routing, is harder to attack than SSL for several reasons;
successful results on Tor thus came later.
First, Tor pads all cells (Tor's application-layer datagrams) to the same constant size,
removing unique packet lengths as a powerful feature for the attacker.
Second, Tor imposes random network conditions upon the client due to random selection of proxies,
so packet sequences are less likely to be consistent.<a href="#section-3-4.2" class="pilcrow">¶</a>
</li>
<li id="section-3-4.3">In the open-world model, Adv wishes to learn whenever a victim
client visits one of a select number of monitored pages <span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span>. Adversaries train
classifiers in this model using monitored and non-monitored websites of their choosing. By
definition, Adv cannot train using client-chosen pages. Clients then visit pages at will
and Adv attempts to learn whenever a monitored page is visited, if any are at all.
This is a realistic model capturing the fact that the set of pages any attacker would be interested in must
necessarily be a small subset of the set of all pages.
As this is a harder model to attack, successful results on this model came later.<a href="#section-3-4.3" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="attacks">
<section id="section-4">
      <h2 id="name-attacks">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-attacks" class="section-name selfRef">Attacks</a>
      </h2>
<ol start="1" type="1" class="normal" id="section-4-1">
        <li id="section-4-1.1">Closed-world WF on TLS: WF attacks date back to applications on SSL first inspired by Wagner and
Schneier <span>[<a href="#wagner1996analysis" class="xref">wagner1996analysis</a>]</span>, in which the authors observed that
packet lengths reveal information about the underlying data. Subsequent attacks
carried out by Cheng et al. <span>[<a href="#cheng1998traffic" class="xref">cheng1998traffic</a>]</span>,
Sun et al. <span>[<a href="#sun2002statistical" class="xref">sun2002statistical</a>]</span>, and Hintz <span>[<a href="#hintz2002fingerprinting" class="xref">hintz2002fingerprinting</a>]</span> continued to show access.
These attacks assume Adv has knowledge of the target resource length(s),
which is not always possible with techniques such as padding.<a href="#section-4-1.1" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4-2">Bissias et al. <span>[<a href="#bissias2005privacy" class="xref">bissias2005privacy</a>]</span> use cross correlation of inter-packet
times in one second time windows as an WF attack. Danezis <span>[<a href="#danezis2009traffic" class="xref">danezis2009traffic</a>]</span> model
websites using a Hidden Markov Model (HMM) and use it, along with TLS traffic traces
revealing only approximate lengths, to identify requested resources on a page. Their results
vary the amount of information available to an adversary when building the HMM. Even in cases
where resource popularity is omitted, which reflects the case where an adversary scrapes static
websites, resource recall was high (86\%).
Liberatore and Levine <span>[<a href="#liberatore2006inferring" class="xref">liberatore2006inferring</a>]</span> proposed two WF attacks
using the Jaccard coefficient and the Naive Bayes classifier.
Herrmann et al. <span>[<a href="#herrmann2009website" class="xref">herrmann2009website</a>]</span> extended the work of Liberatore and Levine with a multinomial
Naive Bayes classifier computed using three input frequency transformations.
Results yielded higher accuracy than that of Liberatore and Levine.
Herrmann's attack is the best in this category, but the authors assume packets which do not fill a MTU
represent packet trailers. Therefore, uniqueness is only accurate modulo the MTU. Efficacy
is limited if endpoints pad packets to the MTU or another fixed length. Modern protocols
such as HTTP/2, QUIC, and TLS 1.3 all provide some form of application-controlled padding.
(Note: These attacks are not successful on Tor.)<a href="#section-4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-4-3">
        <li id="section-4-3.1">Closed-world WF on Tor: Shmatikov and Wang <span>[<a href="#shmatikov2006timing" class="xref">shmatikov2006timing</a>]</span>
presented a WF attack that exploits cross correlation of arrival packet counts in
one second time windows.
Lu et al. <span>[<a href="#lu2010website" class="xref">lu2010website</a>]</span> developed a classifier based on the Levenshtein distance between
ingress and egress packet lengths extracted from packet sequences. Distance is computed between
strings of ingress and egress packet lengths. The training packet sequence with the closest
distance to the testing packet sequence is deemed the match. Dyer et al. <span>[<a href="#dyer2012peek" class="xref">dyer2012peek</a>]</span>
used a Naive Bayes classifier trained with a reduced set of features, including total
response transmission time, length of packets (in each direction), and burst lengths. (Wang
<span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span> notes that measuring burst lengths in Tor is difficult given the presence of
SENDME cells for flow control.) This approach did not yield any measurable improvements over
the SVM classifier from Panchenko et al. Cai et al. <span>[<a href="#cai2012touching" class="xref">cai2012touching</a>]</span> extend the work of Lu et al.
by adding transpositions to the Levenshtein distance computation and normalizing the result,
yielding what the authors refer to as the Optimal String Alignment Distance (OSAD).
Before feature extraction, the authors round TCP packet lengths to the nearest multiple of
600B as an estimate of the number of Tor cells.<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4-4">Wang et al. <span>[<a href="#wang2013improved" class="xref">wang2013improved</a>]</span> tuned the OSAD-based attack to improve its accuracy. Specific changes
include use of Tor cells instead of TCP packets for packet and burst lengths, as well as heuristics
to remove SENDME cells (those not carrying application data) from flows to recover true
burst lengths. The authors also modified the distance computation by removing substitutions,
increasing the weight for egress packets, and varying the transposition cost across the packet
sequence (large weights at the beginning of a trace, and smaller weights near the end, where
variations are expected across repeated page loads.) Wang et al. also developed an alternate classifier
with lower accuracy yet superior performance (quadratic to linear time complexity). It works by
minimizing the sum of two costs: sequence transpositions and sequence deletions or insertions. These
two costs are computed separately, in contrast to the first approach which computes them simultaneously.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Hayes et al. <span>[<a href="#hayes2016k" class="xref">hayes2016k</a>]</span> developed an attack called k-fingerprinting, which uses a k-NN classifier
with features ranked by random decision forests. Their feature set includes timing information, e.g.,
statistics on packets per second, among the higher ranked features. (Higher ranked features have more
weight in the classification phase.) Yan et al. <span>[<a href="#yan2018feature" class="xref">yan2018feature</a>]</span> used similar (manually curated)
features with a CNN-based classifier. Time-based features were among the more effective features
identified. Rahman et al. <span>[<a href="#rahman2019tik" class="xref">rahman2019tik</a>]</span> improved time-based features by focusing on bursts,
e.g., burst length, variance, inter-burst delay, etc., rather than more granular per-packet statistics.
(The latter tend to vary for inconsistencies across packet traces for websites.) This improved accuracy
of existing Deep Learning attacks from Sirinam et al. <span>[<a href="#sirinam2018deep" class="xref">sirinam2018deep</a>]</span>, especially when coupled
with packet direction information.<a href="#section-4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-4-6">
        <li id="section-4-6.1">Open-world WF on Tor and TLS: Panchenko et al. <span>[<a href="#panchenko2011website" class="xref">panchenko2011website</a>]</span>
were the first to use a support vector machine (SVM) classifier trained with web domain-specific
features, such as HTML document sizes, as well as packet lengths.
Wang et al. <span>[<a href="#wang2014effective" class="xref">wang2014effective</a>]</span> also developed an attack using a k-Nearest Neighbors (k-NN) classifier,
which is a supervised machine learning algorithm, targeting the open world setting. The classifier
extracts a large number of features from packet sequences, including raw (ingress and egress)
packet counts, unique packet lengths, direction, burst lengths, and inter-packet times, among others.
(There are 4226 features in total.) The k-NN distance metric is computed as the sum of weighted
feature differences.<a href="#section-4-6.1" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4-7">Kota et al. <span>[<a href="#abe2016fingerprinting" class="xref">abe2016fingerprinting</a>]</span> were the first to use Deep Learning (DL) methods based on Stacked
Denoising Autoencoders for WF attacks. (Autoencoders reduce feature input dimensions when stacked.)
Kota et al. form input vectors from Tor cell directions (+1 or -1). They use no other features.
Using a (small) data set from Wang <span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span>, the classifier achieves a 86% true positive
rate and 2% false positive rate in the open world model. Rimmer et al. <span>[<a href="#rimmer2018automated" class="xref">rimmer2018automated</a>]</span>
applied DL for automated feature generation and classifier construction. Trained with 2,500 traces per
website, their system achieves 96.3% accuracy in the open world model.
Recently, Bhat et al. <span>[<a href="#bhat2018var" class="xref">bhat2018var</a>]</span>, Oh et al. <span>[<a href="#oh2017pfp" class="xref">oh2017pfp</a>]</span>, and Sirinam et al. <span>[<a href="#sirinam2018deep" class="xref">sirinam2018deep</a>]</span>
used Convolutional Neural Networks (CNNs) and Deep Neural Networks (DNNs) for WF attacks. Results from
Sirinam et al. show the best results - 98% on Tor without recent defenses (in Section {{defenses}) -
while performing favorably when select defenses are used for both open and closed world models.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">Yan et al. <span>[<a href="#yan2018feature" class="xref">yan2018feature</a>]</span> studied manual high-information feature extraction from packet traces.
They "exhaustively" examined different levels of features, including packet, burst, TCP, port, and IP address,
summing to 35,683 in total, and distilled them into a diverse set of uncorrelated features for eight
different communication scenarios. Rahman <span>[<a href="#rahman2018using" class="xref">rahman2018using</a>]</span> studied the utility of features derived
from packet interarrival times, including: median interarrival time (per burst), burst packet arrival
time variance, cross-burst interarrival median differences, and others. Using a CNN, results show that
these features yield a non-negligible increase in WF attack accuracy.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="base-rate-fallacy">
<section id="section-5">
      <h2 id="name-base-rate-fallacy">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-base-rate-fallacy" class="section-name selfRef">Base Rate Fallacy</a>
      </h2>
<p id="section-5-1">For all WF attacks, one limitation worth highlighting is the base rate fallacy. This can be summarized
as follows: highly accurate classifiers with a reliable false positive rate (FPR) decrease in
efficacy as the world size increases. Juarez et al. <span>[<a href="#juarez2014critical" class="xref">juarez2014critical</a>]</span> studied its impact by
measuring the Bayesian detection rate (BDR) in comparison to the FPR as a function of world size.
As the world size increases, the BDR approaches 0 while the FPR remains stable, meaning that the probability
of incorrect classifier results increase as well. Juarez et al. partially address the base rate fallacy
problem by adding a confirmation step to their classifier.
Another problem is that web content is (increasingly) dynamic. Most WF attacks, especially those in closed
world models, assume that traces are static. However, Juarez et al. <span>[<a href="#juarez2014critical" class="xref">juarez2014critical</a>]</span> show
this is not the case even for "simple" pages such as google.com. Thus, due to the base fallacy
rate and dynamic nature of content, classifiers require continual retraining in order to ensure accuracy.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defenses">
<section id="section-6">
      <h2 id="name-defenses">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-defenses" class="section-name selfRef">Defenses</a>
      </h2>
<p id="section-6-1">There are at least two types of WF defenses: traffic shaping or morphing algorithms, and traffic
splitting algorithms. This section describes and illustrates examples of both.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="traffic-morphing">
<section id="section-6.1">
        <h3 id="name-traffic-morphing">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-traffic-morphing" class="section-name selfRef">Traffic Morphing</a>
        </h3>
<p id="section-6.1-1">WF defenses are deterministic or randomized algorithms that take as input application data or packet sequences
and return modified application data or packet sequences. Viable defenses seek to minimize the transformation
cost and maximum (theoretical and perfect) attacker accuracy. Naive defenses such as sending a constant stream
of (possibly random) bytes between client and server may be effective though clearly not viable from a cost
perspective. Relevant cost metrics include bandwidth overhead, added time or latency (and its impact on related
metrics such as page load time), and even CPU cost, though the latter is often ignored in favor of the former two.
Wang <span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span> describe defenses as either limited or general. A limited defense is
one which only helps mitigate specific WF attacks by transforming packets in a way to obviate a particular
(set of) feature(s) used by said attacks. In contrast, general defenses help mitigate a variety of attacks.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Several general defenses have been proposed, including BuFLO <span>[<a href="#dyer2012peek" class="xref">dyer2012peek</a>]</span>, which pads packets to
a fixed length of 1500B (the normal MTU) and schedules packets for transmission at fixed period intervals
(and sends fake data if nothing is yet available). Tamaraw <span>[<a href="#wang2014comparing" class="xref">wang2014comparing</a>]</span> is an improvement over BuFLO
that uses two different fixed lengths for packet transmission, rather than one, to save on bandwidth overhead.
Tamaraw also uses two different scheduling rates for ingress and egress packets. The authors chose to make
the ingress packet period smaller than the egress packet period since HTTP responses are often larger in size
and count - if HTTP Push is used - than requests. While provably correct, both BuFLO and Tamaraw limit
the rate at which clients send traffic, and requires all clients to send at a uniform rate. Both requirements
therefore make it difficult to apply as a generic defense in IETF protocols.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Wang et al. also developed Supersequence <span>[<a href="#wang2016website" class="xref">wang2016website</a>]</span>, which attempts to approximate a bandwidth-optimal
deterministic defense. This is done by casting the padding and flow control problem as the shortest common
subsequence (SCS) of the transformed packet trace. Supersequence approximates the solution by learning the optimal
packet scheduling rate; it uses the same padding scheme as Tamaraw.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">Walkie-Talkie <span>[<a href="#wang2015walkie" class="xref">wang2015walkie</a>]</span> is a collection of mechanisms for WF defense. It includes running
the client (browser) in half-duplex mode to batch requests and responses together, as well as randomly
padding traffic so as to mimic traffic of benign websites. It assumes knowledge of traffic patterns for
benign websites, which can be information learned over time or provided by a cooperating peer. Goldberg
and Wang also propose a "randomized" variant that pads real bursts of requests and generates random
request bursts according to a uniform distribution. The half-duplex mode could be implemented as an extension
to a protocol such as HTTP/2, QUIC, or TLS.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Many limited defenses have also been proposed. We list prominent works below.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.1-6.1">Shmatikov and Wang <span>[<a href="#shmatikov2006timing" class="xref">shmatikov2006timing</a>]</span> developed adaptive padding which adds packets to mask
inter-packet times. (This mechanism does not ever delay application data being sent, in contrast to other
padding mechanisms such as BuFLO; see below.)
Juarez et al. <span>[<a href="#juarez2015wtf" class="xref">juarez2015wtf</a>]</span>}<span>[<a href="#juarez2016toward" class="xref">juarez2016toward</a>]</span> also created a WF defense based on adaptive padding called WTF-PAD.
This variant uses application data and "gap" distribution to generate padding for delays. Specifically, when
not sending application data, senders use the gap distribution to drive fake packet transmission.
WTF-PAD can be run by a single endpoint, though it is assumed that both client and server participate.
As mentioned above, protocols such as HTTP/2, QUIC, and TLS 1.3 offer a mechanism by which applications can
send padding. WTF-PAD could therefore be implemented as an extension to any of these protocols, either by
applications supplying padding distributions or the system learning them over time.<a href="#section-6.1-6.1" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.2">In the context of HTTP, Danezis <span>[<a href="#danezis2009traffic" class="xref">danezis2009traffic</a>]</span> proposed padding: URLs, content, and even HTML
document structures to mask application data lengths.<a href="#section-6.1-6.2" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.3">Wright et al. <span>[<a href="#wright2009traffic" class="xref">wright2009traffic</a>]</span> developed traffic morphing, which pads packets in such a way
so as to make the sequence from one page have characteristics of another (non-monitored or benign) page.
This technique requires application-specific knowledge about benign pages and is therefore best implemented
outside of the transport layer.<a href="#section-6.1-6.3" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.4">Nithyanand et al. <span>[<a href="#nithyanand2014glove" class="xref">nithyanand2014glove</a>]</span> developed a mechanism called Glove,
wherein traces were first clustered and then morphed (via dummy insertion, packet
merging, splitting, and delaying) to look indistinguishable within clusters. When used
to protect the Alexa top 500 domains, Glove performs well with respect to bandwidth
overhead when compared to BuFLO and CS-BuFLO. Varying the cluster size can tune
Glove's bandwidth overhead.<a href="#section-6.1-6.4" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.5">Pironti et al. <span>[<a href="#pironti2012identifying" class="xref">pironti2012identifying</a>]</span> developed a TLS-based fragmentation and padding
scheme designed to hide the length of application data within a certain range with record padding.
The mechanism works by iteratively splitting application data into variable sized segments. Applications
can guide the range of viable lengths provided such information is available.<a href="#section-6.1-6.5" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.6">Luo et al. <span>[<a href="#luo2011httpos" class="xref">luo2011httpos</a>]</span> created HTTPS with Obfuscation (HTTPOS), which is a client-side
mechanism for obfuscating HTTP traffic. It uses the HTTP Range method to receive resources in chunks, TCP
MSS to limit the size of individual chunks, and advertised window size to control the flow of chunks
in transmission.<a href="#section-6.1-6.6" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.7">Panchenko et al. <span>[<a href="#panchenko2011website" class="xref">panchenko2011website</a>]</span> developed Decoy, which is a simple mechanism that loads
a benign page alongside a real page. This seeks to mask the real page load by properties of the "decoy" page.
As with morphing, this defense requires application-specific knowledge about benign pages and is best
implemented outside of the transport layer.<a href="#section-6.1-6.7" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.8">The Tor project implemented HTTP pipelining <span>[<a href="#perry2011experimental" class="xref">perry2011experimental</a>]</span>, which bundles egress HTTP/1.1
requests into batches of varying sizes with random orders. Batching requests to mask request and response sizes
could be made easier with HTTP/2 <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>, HTTP/3, and QUIC, since these protocol naturally support
multiplexing. However, pipelining and batching may necessarily introduce latency delays that negatively impact
the user experience.<a href="#section-6.1-6.8" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.9">Cherubin et al. <span>[<a href="#cherubin2017website" class="xref">cherubin2017website</a>]</span> design two application-layer defenses called Application
Layer Padding Concerns Adversaries (ALPaCA) and Lightweight application-Layer Masquerading Add-on (LLaMA).
ALPaCA is a server-side defense that pads first-party content (deterministically or probabilistically)
according to a known distribution. (Deterministic padding similar to Tamaraw performs worse than
probabilistic padding.) LLaMA is similar to randomized pipelining, yet differs in that requests are also
delayed (if necessary) and spurious requests are generated according to some probability distribution.
Comparatively, ALPaCA yields a greater reduction in WF attack accuracy than LLaMA.<a href="#section-6.1-6.9" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.10">Lu et al. <span>[<a href="#lu2018dynaflow" class="xref">lu2018dynaflow</a>]</span> designed DynaFlow, which is a defense that dynamically adjusts
traffic flows using a combination of burst pattern morphing, constant traffic flow with flexible
intervals, and burst padding. DynaFlow overhead is 40% less than that of Tamaraw and was shown
to have similar benefits.<a href="#section-6.1-6.10" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.11">Rahman <span>[<a href="#rahman18gan" class="xref">rahman18gan</a>]</span> uses generative adversarial networks (GANs) to modify candidate burst properties
of packet traces, i.e., by inserting dummy packets, such that they appear indistinguishable from other traces.
Normally, the generator component in a GAN uses random noise to produce information that matches a target
data distribution as classified by the discriminator component. Rahman uses a modified GAN architecture
wherein the generator produces padding (dummy packets) for input data such that the discriminator cannot
distinguish it from noise, or a desired burst packet sequence. Preliminary results with the GAN trained and
tested on defended traffic, i.e., traffic already subject to some form of WF defense, show a 9% increase in
bandwidth and 15% decrease in attack accuracy (from 98% to 85% in a closed world setting).<a href="#section-6.1-6.11" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.12">Imani et al. <span>[<a href="#imanimockingbird" class="xref">imanimockingbird</a>]</span> developed Mockingbird, a defense built on using generated adversarial
examples, i.e., dummy traffic designed to disrupt classifier behavior, aimed towards model misclassification.
When run on classifiers trained without adversarial examples, Mockingbird reduced state-of-the-art DF attacks
and CUMUL attacks from <span>[<a href="#panchenko2016website" class="xref">panchenko2016website</a>]</span> from 98% to 3% and 92% to 31%, respectively. Conversely, classifiers
trained and hardened with adversarial examples only reduce attack accuracy from 95% to between 25-57%, respectively.
Classification results for half-duplex traces, i.e., those in which traffic flows in half-duplex mode, are lower.
Mockingbird's bandwidth overhead is tunable based on parameters that control the internal traffic shaping algorithm.<a href="#section-6.1-6.12" class="pilcrow">¶</a>
</li>
<li id="section-6.1-6.13">Gong et al. developed <span>[<a href="#gong2020zero" class="xref">gong2020zero</a>]</span> is a lightweight defense that does not delay any packets, minimizing its effect on
user experience. Instead of adding packets during a packet trace in order to obfuscate which page it came from, GLUE adds packets between
packet traces (during user think time/downtime) to merge them together, creating a seamless sequence of packets covering
multiple page loads. Attackers are unable to train classifiers for multiple contiguous traces and also unable to identify
individual page traces from the sequence. This is in part because the GLUE used is itself a real packet trace, thwarting
attacker classification. GLUE also adds extra noise packets ("FRONT") in the first trace as it is vulnerable otherwise.<a href="#section-6.1-6.13" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="traffic-splitting">
<section id="section-6.2">
        <h3 id="name-traffic-splitting">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-traffic-splitting" class="section-name selfRef">Traffic Splitting</a>
        </h3>
<p id="section-6.2-1">Traffic splitting is a type of defense wherein application data is sent over multiple, disjoint network paths.
Multipath TCP (MPTCP) is one type of "traffic splitting" protocol, wherein an endpoint may send TCP segments for a
single connection over multiple interfaces. This is commonly done for multi-homed devices, such as mobile
devices with cellular and WiFi or wired network connections. Traffic splitting assumes that guided traffic distribution
reduces information available to an adversary, and thereby decreases the success probability of WF attacks. Traffic
splitting defenses differ in the algorithm used for traffic distribution.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Henri et al. <span>[<a href="#henri2020protecting" class="xref">henri2020protecting</a>]</span> studied several traffic splitting algorithms, including: weighted and non-weighted
round-robin path splitting, incoming and outgoing path split, fixed-probability splitting, and variants of per-connection
uniform probability splitting. The best results came from a per-connection path splitting variant where the
maximum number of packets sent on any given path was limited by a random variable chosen from a geometric distribution.
(Once this limit was reached, a new path was selected uniformly at random.) De la Cadena et al. <span>[<a href="#de2019poster" class="xref">de2019poster</a>]</span>
also study path splitting algorithmss. They conclude that a weighted random path selection algorithm works best.
(The authors do not give specifics of path weight probability derivation.)<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="open-problems-and-directions">
<section id="section-7">
      <h2 id="name-open-problems-and-direction">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-open-problems-and-direction" class="section-name selfRef">Open Problems and Directions</a>
      </h2>
<p id="section-7-1">To date, WF attacks target clients running over Tor or some other anonymizing service, meaning that WF
attacks are likely more accurate on normal TLS-protected connections. Moreover, attacks normally assume clients
use HTTP/1.1 with parallel connections for parallel resource fetches. In recent years, however, protocols
such as SPDY, HTTP/2, and QUIC with built-in padding support and multiplexed stream-based connections
should make existing attacks more difficult to carry out. That said, it is unclear how exactly these protocol
design trends will impact WF attacks. A non-exhaustive list of questions that warrant further research
are below:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-7-2">
        <li id="section-7-2.1">How does connection coalescing and consolidation affect WF attacks? Technologies such as DNS-over-HTTPS
and ESNI favor architectures wherein a single network or connection can serve multiple origins or resources.
With connection coalescing, traffic for multiple resources is sent on the same connection, thereby adding
effects similar to that of the Decoy defense mechanism described in <a href="#defenses" class="xref">Section 6</a><a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7-2.2">To what extent does protocol multiplexing increase WF attack difficulty? Using a single connection
with multiple streams to avoid HoL blocking saves on connection startup and bandwidth costs while simultaneously
mixing information from multiple requests and resources on the same connection.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7-2.3">How can protocol features such as HTTP Push be used to improve WF defense efficacy? Defenses without
cooperative peer support often induce suboptimal bandwidth or latency costs. If both endpoints of a connection
participate in the defense, even proactively with Push, perhaps this could be improved.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7-2.4">Can connection bootstrapping techniques such as those used by ESNI be used to distribute WF defense
information? One possible approach is to distribute client padding profiles derived from CDN knowledge
of serviced resources.<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
<li id="section-7-2.5">How can clients build, use, and possibly share WF defense information to benefit others?<a href="#section-7-2.5" class="pilcrow">¶</a>
</li>
<li id="section-7-2.6">How can applications package websites and subresources in such a way that limits unique information?
For example, websites link to third party resources in an ad-hoc fashion, causing the subsequent trace of
browser fetches to possibly uniquely identify the website.<a href="#section-7-2.6" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-7-3">Research into the above questions will help the IETF community better understand the extent to which
WF attacks are a problem for Internet users in general.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">It is worth mentioning that traffic-based WF attacks may not be required to achieve the desired
goal of learning a connection's destination. Network connections by nature reveal information
about endpoint behavior. The relationship between network address and domains, especially when
stable and unique, are a strong signal for website fingerprinting. Trevisan et al. <span>[<a href="#trevisan2016towards" class="xref">trevisan2016towards</a>]</span>
explored use of this signal as a reliable mechanism for website fingerprinting. They find that
most major services (domains) have clearly associated IP address(es), though
these addresses may change over time. Jiang et al. <span>[<a href="#jiang2007lightweight" class="xref">jiang2007lightweight</a>]</span>
and Tammaro et al. <span>[<a href="#tammaro2012exploiting" class="xref">tammaro2012exploiting</a>]</span> also previously came to the same
conclusion. Address-based website fingerprinting was also explored by Patil and
Borisov <span>[<a href="#patil2019can" class="xref">patil2019can</a>]</span>, wherein they showed that addresses, especially when
grouped together as part of a single web page load, leak a substantial amount of
information about the corresponding domain. Thus, in general, classifiers that rely
solely on network addresses may be used to aid website fingerprinting attacks.<a href="#section-7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-design-considerations">
<section id="section-8">
      <h2 id="name-protocol-design-considerati">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-protocol-design-considerati" class="section-name selfRef">Protocol Design Considerations</a>
      </h2>
<p id="section-8-1">New protocols such as TLS 1.3 and QUIC are designed with privacy-protections in mind.
TLS 1.3, for example, supports record-layer padding <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, although it is
not used widely in practice. Despite this, TLS connections still leak metadata, including
negotiatied ciphersuites. (See <span>[<a href="#fordTLSMetadata" class="xref">fordTLSMetadata</a>]</span> for a discussion of this issue.)
QUIC is more aggressive in its use of encryption as both a mitigation for middlebox
ossificatiion and privacy enhancement. IPsec Traffic Flow Confidentiality <span>[<a href="#RFC4303" class="xref">RFC4303</a>]</span>
and Traffic Flow Security <span>[<a href="#I-D.ietf-ipsecme-iptfs" class="xref">I-D.ietf-ipsecme-iptfs</a>]</span> are two mechanisms by which
endpoints can ESP datagrams to mask size metadata.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Future protocols should follow these trends when possible to remove unnecessary metadata from
the network.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">This document surveys security and privacy attacks and defenses on encrypted TLS connections.
It does not introduce, specify, or recommend any particular mitigation to the aforementioned
attacks.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document makes no IANA requests.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="abe2016fingerprinting">[abe2016fingerprinting]</dt>
<dd>
<span class="refTitle">"Fingerprinting attack on tor anonymity using deep learning"</span>, <span class="seriesInfo">Asia-Pacific Advanced Network, 2016 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="backes2013preventing">[backes2013preventing]</dt>
<dd>
<span class="refTitle">"Preventing Side-Channel Leaks in Web Traffic -- A Formal Approach"</span>, <span class="seriesInfo">NDSS, 2013 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="bhat2018var">[bhat2018var]</dt>
<dd>
<span class="refTitle">"Var-CNN and DynaFlow -- Improved Attacks and Defenses for Website Fingerprinting"</span>, <span class="seriesInfo">arXiv preprint arXiv:1802.10215 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="bissias2005privacy">[bissias2005privacy]</dt>
<dd>
<span class="refTitle">"Privacy vulnerabilities in encrypted HTTP streams"</span>, <span class="seriesInfo">International Workshop on Privacy Enhancing Technologies, 2005 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="cai2012touching">[cai2012touching]</dt>
<dd>
<span class="refTitle">"Touching from a distance -- Website fingerprinting attacks and defenses"</span>, <span class="seriesInfo">ACM conference on Computer and communications security, 2012 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="cheng1998traffic">[cheng1998traffic]</dt>
<dd>
<span class="refTitle">"Traffic analysis of SSL encrypted web browsing"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="cherubin2017website">[cherubin2017website]</dt>
<dd>
<span class="refTitle">"Website fingerprinting defenses at the application layer"</span>, <span class="seriesInfo">Privacy Enhancing Technologies, 2017 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="coull2007web">[coull2007web]</dt>
<dd>
<span class="refTitle">"On Web Browsing Privacy in Anonymized NetFlows"</span>, <span class="seriesInfo">USENIX Security Symposium </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="CRIME">[CRIME]</dt>
<dd>
<span class="refTitle">"The CRIME Attack"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://www.ekoparty.org/archive/2012/CRIME_ekoparty2012.pdf">https://www.ekoparty.org/archive/2012/CRIME_ekoparty2012.pdf</a>&gt;</span>. </dd>
<dt id="danezis2009traffic">[danezis2009traffic]</dt>
<dd>
<span class="refTitle">"Traffic Analysis of the HTTP Protocol over TLS"</span>, <span class="seriesInfo">2009 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="de2019poster">[de2019poster]</dt>
<dd>
<span class="refTitle">"Traffic Splitting to Counter Website Fingerprinting"</span>, <time datetime="2019">2019</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3319535.3363249">https://dl.acm.org/doi/10.1145/3319535.3363249</a>&gt;</span>. </dd>
<dt id="dyer2012peek">[dyer2012peek]</dt>
<dd>
<span class="refTitle">"Peek-a-boo, i still see you -- Why efficient traffic analysis countermeasures fail"</span>, <span class="seriesInfo">IEEE Symposium on Security and Privacy, 2012 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="fordTLSMetadata">[fordTLSMetadata]</dt>
<dd>
<span class="refTitle">"Metadata Protection Considerations for TLS Present and Future"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="http://bford.info/pub/net/tlsmeta.pdf">http://bford.info/pub/net/tlsmeta.pdf</a>&gt;</span>. </dd>
<dt id="foremski2014dns">[foremski2014dns]</dt>
<dd>
<span class="refTitle">"DNS-Class -- immediate classification of IP flows using DNS"</span>, <span class="seriesInfo">International Journal of Network Management </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="gong2010fingerprinting">[gong2010fingerprinting]</dt>
<dd>
<span class="refTitle">"Fingerprinting websites using remote traffic analysis"</span>, <span class="seriesInfo">Proceedings of the 17th ACM conference on Computer and communications security </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="gong2020zero">[gong2020zero]</dt>
<dd>
<span class="refTitle">"Zero-delay Lightweight Defenses against Website Fingerprinting"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://www.usenix.org/system/files/sec20summer_gong_prepub.pdf">https://www.usenix.org/system/files/sec20summer_gong_prepub.pdf</a>&gt;</span>. </dd>
<dt id="hayes2016k">[hayes2016k]</dt>
<dd>
<span class="refTitle">"k-fingerprinting -- A Robust Scalable Website Fingerprinting Technique"</span>, <span class="seriesInfo">USENIX Security Symposium, 2016 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="henri2020protecting">[henri2020protecting]</dt>
<dd>
<span class="refTitle">"Protecting against Website Fingerprinting with Multihoming"</span>, <time datetime="2020">2020</time>, <span>&lt;<a href="https://petsymposium.org/2020/files/papers/issue2/popets-2020-0019.pdf">https://petsymposium.org/2020/files/papers/issue2/popets-2020-0019.pdf</a>&gt;</span>. </dd>
<dt id="herrmann2009website">[herrmann2009website]</dt>
<dd>
<span class="refTitle">"Website fingerprinting -- attacking popular privacy enhancing technologies with the multinomial naive-bayes classifier"</span>, <span class="seriesInfo">ACM workshop on Cloud computing security, 2009 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="hintz2002fingerprinting">[hintz2002fingerprinting]</dt>
<dd>
<span class="refTitle">"Fingerprinting websites using traffic analysis"</span>, <span class="seriesInfo">International Workshop on Privacy Enhancing Technologies, 2002 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="I-D.ietf-ipsecme-iptfs">[I-D.ietf-ipsecme-iptfs]</dt>
<dd>
<span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"IP Traffic Flow Security"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ipsecme-iptfs-01</span>, <time datetime="2020-03-02">2 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-iptfs-01.txt">http://www.ietf.org/internet-drafts/draft-ietf-ipsecme-iptfs-01.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-quic-transport">[I-D.ietf-quic-transport]</dt>
<dd>
<span class="refAuthor">Iyengar, J.</span><span class="refAuthor"> and M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-27</span>, <time datetime="2020-02-21">21 February 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-27.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-27.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-tls-esni">[I-D.ietf-tls-esni]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Oku, K.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"Encrypted Server Name Indication for TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-05</span>, <time datetime="2019-11-04">4 November 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-05.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-05.txt</a>&gt;</span>. </dd>
<dt id="imanimockingbird">[imanimockingbird]</dt>
<dd>
<span class="refTitle">"Mockingbird -- Defending Against Deep-Learning-Based Website Fingerprinting Attacks with Adversarial Traces"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://arxiv.org/pdf/1902.06626.pdf">https://arxiv.org/pdf/1902.06626.pdf</a>&gt;</span>. </dd>
<dt id="jiang2007lightweight">[jiang2007lightweight]</dt>
<dd>
<span class="refTitle">"Lightweight application classification for network management"</span>, <span class="seriesInfo">SIGCOMM workshop on Internet network management, 2007 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="juarez2014critical">[juarez2014critical]</dt>
<dd>
<span class="refTitle">"A critical evaluation of website fingerprinting attacks"</span>, <span class="seriesInfo">ACM SIGSAC Conference on Computer and Communications Security, 2014 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="juarez2015wtf">[juarez2015wtf]</dt>
<dd>
<span class="refTitle">"WTF-PAD -- toward an efficient website fingerprinting defense for tor"</span>, <span class="seriesInfo">CoRR, abs/1512.00524 </span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://pdfs.semanticscholar.org/0f54/4d0845cb9f317722759dc49e1493ef30d83d.pdf">https://pdfs.semanticscholar.org/0f54/4d0845cb9f317722759dc49e1493ef30d83d.pdf</a>&gt;</span>. </dd>
<dt id="juarez2016toward">[juarez2016toward]</dt>
<dd>
<span class="refTitle">"Toward an efficient website fingerprinting defense"</span>, <span class="seriesInfo">European Symposium on Research in Computer Security, 2016 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="li2018can">[li2018can]</dt>
<dd>
<span class="refTitle">"Can We Learn What People Are Doing from Raw DNS Queries?"</span>, <span class="seriesInfo">IEEE INFOCOM 2018-IEEE Conference on Computer Communications </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="liberatore2006inferring">[liberatore2006inferring]</dt>
<dd>
<span class="refTitle">"Inferring the source of encrypted HTTP connections"</span>, <span class="seriesInfo">ACM Conference on Computer and Communications Security, 2006 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="lu2010website">[lu2010website]</dt>
<dd>
<span class="refTitle">"Website fingerprinting and identification using ordered feature sequences"</span>, <span class="seriesInfo">European Symposium on Research in Computer Security, 2010 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="lu2018dynaflow">[lu2018dynaflow]</dt>
<dd>
<span class="refTitle">"DynaFlow -- An Efficient Website Fingerprinting Defense Based on Dynamically-Adjusting Flows"</span>, <span class="seriesInfo">Workshop on Privacy in the Electronic Society, 2018 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="luo2011httpos">[luo2011httpos]</dt>
<dd>
<span class="refTitle">"HTTPOS -- Sealing Information Leaks with Browser-side Obfuscation of Encrypted Flows"</span>, <span class="seriesInfo">NDSS, 2011 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="miller2014know">[miller2014know]</dt>
<dd>
<span class="refTitle">"I know why you went to the clinic -- Risks and realization of https traffic analysis"</span>, <span class="seriesInfo">International Symposium on Privacy Enhancing Technologies Symposium, 2014 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="nithyanand2014glove">[nithyanand2014glove]</dt>
<dd>
<span class="refTitle">"Glove -- A bespoke website fingerprinting defense"</span>, <span class="seriesInfo">Proceedings of the 13th Workshop on Privacy in the Electronic Society </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="oh2017pfp">[oh2017pfp]</dt>
<dd>
<span class="refTitle">"p-FP -- Extraction, Classification, and Prediction of Website Fingerprints with Deep Learning"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="panchenko2011website">[panchenko2011website]</dt>
<dd>
<span class="refTitle">"Website fingerprinting in onion routing based anonymization networks"</span>, <span class="seriesInfo">ACM workshop on Privacy in the electronic society, 2011 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="panchenko2016website">[panchenko2016website]</dt>
<dd>
<span class="refTitle">"Website Fingerprinting at Internet Scale"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://www.freehaven.net/anonbib/cache/fingerprinting-ndss2016.pdf">https://www.freehaven.net/anonbib/cache/fingerprinting-ndss2016.pdf</a>&gt;</span>. </dd>
<dt id="patil2019can">[patil2019can]</dt>
<dd>
<span class="refTitle">"What can you learn from an IP?"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://irtf.org/anrw/2019/anrw2019-final44-acmpaginated.pdf">https://irtf.org/anrw/2019/anrw2019-final44-acmpaginated.pdf</a>&gt;</span>. </dd>
<dt id="perry2011experimental">[perry2011experimental]</dt>
<dd>
<span class="refTitle">"Experimental defense for website traffic fingerprinting"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://blog.torproject.org/experimental-defense-website-traffic-fingerprinting">https://blog.torproject.org/experimental-defense-website-traffic-fingerprinting</a>&gt;</span>. </dd>
<dt id="pironti2012identifying">[pironti2012identifying]</dt>
<dd>
<span class="refTitle">"Identifying website users by TLS traffic analysis -- New attacks and effective countermeasures"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="rahman18gan">[rahman18gan]</dt>
<dd>
<span class="refTitle">"Generating Adversarial Packets for Website Fingerprinting Defense"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://www.rahmanmsaidur.com/projects/Fall_18_Generating_Adversarial_Packets.pdf">https://www.rahmanmsaidur.com/projects/Fall_18_Generating_Adversarial_Packets.pdf</a>&gt;</span>. </dd>
<dt id="rahman2018using">[rahman2018using]</dt>
<dd>
<span class="refTitle">"Using Packet Timing Information in Website Fingerprinting"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="rahman2019tik">[rahman2019tik]</dt>
<dd>
<span class="refTitle">"Tik-Tok -- The Utility of Packet Timing in Website Fingerprinting Attacks"</span>, <time datetime="n.d.">n.d.</time>, <span>&lt;<a href="https://arxiv.org/pdf/1902.06421.pdf">https://arxiv.org/pdf/1902.06421.pdf</a>&gt;</span>. </dd>
<dt id="reed2017identifying">[reed2017identifying]</dt>
<dd>
<span class="refTitle">"Identifying https-protected netflix videos in real-time"</span>, <span class="seriesInfo">ACM on Conference on Data and Application Security and Privacy, 2017 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="RFC4303">[RFC4303]</dt>
<dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dt id="RFC7540">[RFC7540]</dt>
<dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dt id="RFC8484">[RFC8484]</dt>
<dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dt id="rimmer2018automated">[rimmer2018automated]</dt>
<dd>
<span class="refTitle">"Automated website fingerprinting through deep learning"</span>, <span class="seriesInfo">Network &amp; Distributed System Security Symposium (NDSS), 2018 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="schuster2017beauty">[schuster2017beauty]</dt>
<dd>
<span class="refTitle">"Beauty and the burst -- Remote identification of encrypted video streams"</span>, <span class="seriesInfo">USENIX Security, 2017 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="shmatikov2006timing">[shmatikov2006timing]</dt>
<dd>
<span class="refTitle">"Timing analysis in low-latency mix networks -- Attacks and defenses"</span>, <span class="seriesInfo">European Symposium on Research in Computer Security, 2006 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="shulman2014pretty">[shulman2014pretty]</dt>
<dd>
<span class="refTitle">"Pretty bad privacy -- Pitfalls of DNS encryption"</span>, <span class="seriesInfo">Workshop on Privacy in the Electronic Society, 2014 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="siby2018dns">[siby2018dns]</dt>
<dd>
<span class="refTitle">"DNS Privacy not so private -- the traffic analysis perspective"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="sirinam2018deep">[sirinam2018deep]</dt>
<dd>
<span class="refTitle">"Deep fingerprinting -- Undermining website fingerprinting defenses with deep learning"</span>, <span class="seriesInfo">arXiv preprint arXiv:1801.02265 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="sun2002statistical">[sun2002statistical]</dt>
<dd>
<span class="refTitle">"Statistical identification of encrypted web browsing traffic"</span>, <span class="seriesInfo">IEEE, 2002 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="tammaro2012exploiting">[tammaro2012exploiting]</dt>
<dd>
<span class="refTitle">"Exploiting packet-sampling measurements for traffic characterization and classification"</span>, <span class="seriesInfo">International Journal of Network Management, 2012 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="TIME">[TIME]</dt>
<dd>
<span class="refTitle">"A Perfect CRIME? Only TIME Will Tell"</span>, <span class="seriesInfo">Black Hat Europe 2013 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="trevisan2016towards">[trevisan2016towards]</dt>
<dd>
<span class="refTitle">"Towards web service classification using addresses and DNS"</span>, <span class="seriesInfo">Wireless Communications and Mobile Computing Conference (IWCMC), 2016 International. IEEE, 2016 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wagner1996analysis">[wagner1996analysis]</dt>
<dd>
<span class="refTitle">"Analysis of the SSL 3.0 protocol"</span>, <span class="seriesInfo">USENIX Workshop on Electronic Commerce Proceedings, 1996 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wang2013improved">[wang2013improved]</dt>
<dd>
<span class="refTitle">"Improved website fingerprinting on tor"</span>, <span class="seriesInfo">Workshop on privacy in the electronic society, 2013 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wang2014comparing">[wang2014comparing]</dt>
<dd>
<span class="refTitle">"Comparing website fingerprinting attacks and defenses"</span>, <span class="seriesInfo">Technical Report 2013-30, CACR, 2013. </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wang2014effective">[wang2014effective]</dt>
<dd>
<span class="refTitle">"Effective Attacks and Provable Defenses for Website Fingerprinting"</span>, <span class="seriesInfo">USENIX Security Symposium, 2014 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wang2015walkie">[wang2015walkie]</dt>
<dd>
<span class="refTitle">"Walkie-talkie -- An effective and efficient defense against website fingerprinting"</span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wang2016website">[wang2016website]</dt>
<dd>
<span class="refTitle">"Website fingerprinting -- Attacks and defenses"</span>, <span class="seriesInfo">University of Waterloo </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="wright2009traffic">[wright2009traffic]</dt>
<dd>
<span class="refTitle">"Traffic Morphing -- An Efficient Defense Against Statistical Traffic Analysis"</span>, <span class="seriesInfo">NDSS, 2009 </span>, <time datetime="n.d.">n.d.</time>. </dd>
<dt id="yan2018feature">[yan2018feature]</dt>
<dd>
<span class="refTitle">"Feature selection for website fingerprinting"</span>, <span class="seriesInfo">Proceedings on Privacy Enhancing Technologies, 2018 </span>, <time datetime="n.d.">n.d.</time>. </dd>
</dl>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">The authors would like to thank Frederic Jacobs and Tim Taubert for feedback
on earlier versions of this document.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ian Goldberg</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:iang@uwaterloo.ca" class="email">iang@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tao Wang</span></div>
<div dir="auto" class="left"><span class="org">HK University of Science and Technology</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:taow@cse.ust.hk" class="email">taow@cse.ust.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cawood@apple.com" class="email">cawood@apple.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
